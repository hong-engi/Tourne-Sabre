{"ast":null,"code":"import sword from './sword.png';\nimport { map } from './map.js';\nimport { Player, Item } from './object.js';\nconst map_size = 1200;\nconst center_h = map_size / 2;\nconst center_w = map_size / 2;\nvar img = new Image();\nimg.src = sword; //todo : canvas.width,canvas.height??\n\nfunction draw(ctx, player) {\n  defaultMap(ctx);\n\n  for (let i = 0; i < map.length; i++) {\n    if (map[i] instanceof Player) {\n      if (map[i].pos.dist(player.pos) < 400 - map[i].r) drawPlayer(ctx, player, map[i]);\n    }\n\n    if (map[i] instanceof Item) {\n      if (map[i].pos.dist(player.pos) < 400 - map[i].r) drawItem(ctx, player, map[i]);\n    }\n  }\n\n  player.sw_rot(1 * (2 * Math.PI / 180));\n}\n\nfunction defaultMap(ctx) {\n  var circle = new Path2D();\n  circle.arc(center_h, center_w, 400, 0, 2 * Math.PI);\n  ctx.fillStyle = 'white';\n  ctx.strokeStyle = 'gray';\n  ctx.lineWidth = 5;\n  ctx.fill(circle);\n  ctx.stroke(circle);\n}\n\nfunction drawItem(ctx, i) {}\n\nfunction drawPlayer(ctx, me, p) {\n  var circle = new Path2D();\n  let dpos = p.pos.addv(me.pos, -1),\n      x = center_w + dpos.x,\n      y = center_h + dpos.y;\n  circle.arc(x, y, p.r, 0, 2 * Math.PI);\n  ctx.fillStyle = 'red';\n  ctx.strokeStyle = 'black';\n  ctx.lineWidth = 1;\n  ctx.fill(circle);\n  ctx.stroke(circle);\n  drawSword(ctx, me, p);\n  drawString(ctx, me, p, center_h, center_w);\n}\n\nfunction drawSword(ctx, me, p) {\n  const angle = -p.sw_angle;\n  let dpos = p.pos.addv(me.pos, -1),\n      x = center_w + dpos.x,\n      y = center_h + dpos.y;\n  const r = p.sw_r,\n        w = p.sw_w,\n        h = p.sw_h;\n  ctx.save();\n  ctx.translate(x, y);\n  ctx.rotate(angle);\n  ctx.drawImage(img, x - w / 2, y - r - h / 2, w, h);\n  ctx.restore();\n}\n\nfunction drawString(ctx, me, p) {\n  let dpos = p.pos.addv(me.pos, -1),\n      x = center_w + dpos.x,\n      y = center_h + dpos.y;\n  ctx.fillStyle = 'black';\n  ctx.font = '15px Dosis-Bold';\n  let text = p.name;\n  let width = ctx.measureText(text).width;\n  ctx.fillText(text, x - width / 2, y + 5);\n}\n\nexport default draw;","map":{"version":3,"sources":["/Users/hong-eungi/git/tourne-sabre/frontend/src/mapdraw.js"],"names":["sword","map","Player","Item","map_size","center_h","center_w","img","Image","src","draw","ctx","player","defaultMap","i","length","pos","dist","r","drawPlayer","drawItem","sw_rot","Math","PI","circle","Path2D","arc","fillStyle","strokeStyle","lineWidth","fill","stroke","me","p","dpos","addv","x","y","drawSword","drawString","angle","sw_angle","sw_r","w","sw_w","h","sw_h","save","translate","rotate","drawImage","restore","font","text","name","width","measureText","fillText"],"mappings":"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","sourcesContent":["import sword from './sword.png'\nimport {map} from './map.js'\nimport {Player, Item} from './object.js'\nconst map_size = 1200;\nconst center_h = map_size/2;\nconst center_w = map_size/2;\n\nvar img = new Image();\nimg.src = sword; \n\n//todo : canvas.width,canvas.height??\nfunction draw(ctx,player) {\n    defaultMap(ctx)\n    for(let i=0;i<map.length;i++){\n        if(map[i] instanceof Player){\n            if(map[i].pos.dist(player.pos)<400-map[i].r)\n                drawPlayer(ctx,player,map[i])\n        }\n        if(map[i] instanceof Item){\n            if(map[i].pos.dist(player.pos)<400-map[i].r)\n                drawItem(ctx,player,map[i])\n        }\n    }\n    player.sw_rot(1*(2*Math.PI/180))\n}\n\nfunction defaultMap(ctx){\n    var circle = new Path2D();\n    circle.arc(center_h, center_w, 400, 0, 2 * Math.PI);\n    ctx.fillStyle='white';\n    ctx.strokeStyle='gray';\n    ctx.lineWidth=5;\n    ctx.fill(circle);\n    ctx.stroke(circle);\n}\nfunction drawItem(ctx,i){\n\n}\n\nfunction drawPlayer(ctx,me,p){\n    var circle = new Path2D();\n    let dpos = p.pos.addv(me.pos,-1), x=center_w+dpos.x, y=center_h+dpos.y;\n    circle.arc(x, y, p.r, 0, 2 * Math.PI);\n    ctx.fillStyle='red';\n    ctx.strokeStyle='black';\n    ctx.lineWidth=1;\n    ctx.fill(circle);\n    ctx.stroke(circle);\n    drawSword(ctx,me,p)\n    drawString(ctx,me,p,center_h,center_w)\n}\n\nfunction drawSword(ctx,me,p){\n    const angle = -p.sw_angle;\n    let dpos = p.pos.addv(me.pos,-1), x=center_w+dpos.x, y=center_h+dpos.y;\n    const r = p.sw_r,w=p.sw_w,h=p.sw_h;\n    ctx.save();\n    ctx.translate(x,y);\n    ctx.rotate(angle);\n    ctx.drawImage(img,x-w/2,y-r-h/2,w,h);\n    ctx.restore();\n}\n\nfunction drawString(ctx,me,p){\n    let dpos = p.pos.addv(me.pos,-1), x=center_w+dpos.x, y=center_h+dpos.y;\n    ctx.fillStyle='black';\n    ctx.font = '15px Dosis-Bold';\n    let text = p.name\n    let width = ctx.measureText(text).width;\n    ctx.fillText(text,x-(width/2),y+5)\n}\n\nexport default draw;"]},"metadata":{},"sourceType":"module"}